# Item 16: new 및 delete를 사용할 때는 형태를 반드시 맞추자

new로 객체를 동적 할당하면 메모리가 할당된 다음 할당된 메모리에 대해 한 개 이상의 생성자가 호출됨

delete 연산자를 사용하면 기존에 할당된 메모리에 대해 한 개 이상의 소멸자가 호출되고, 그 후에 메모리가 해제됨

---

new로 힙에 만들어진 단일 객체의 메모리 배치구조는 객체 배열에 대한 메모리 배치구조와 다름

배열을 위해 만들어지는 힙 메모리에는 대개 배열원소의 개수가 들어가기 때문에 delete 연산자는 소멸자가 몇 번 호출되는지 쉽게 알 수 있음

단일 객체용 힙 메모리에는 이런 정보가 없음

포인터가 배열을 가리키고 있는 경우 대괄호 쌍([])을 delete 뒤에 붙여 배열 크기 정보가 있다는 것을 알려줘야 함

그렇지 않으면 단일 객체로 간주

```c++
std::string *stringPtr1 = new std::string;
std::string *stringPtr2 = new std::string[100];
...
delete stringPtr1;  // 객체 한 개 삭제
delete [] stringPtr2;  // 객체 배열 삭제
```

new 표현식에 []를 사용했다면, 여기에 대응되는 delete 표현식에도 []를 써야함

---

동적 할당된 메모리에 대한 포인터를 멤버 데이터로 갖고 있는 클래스가 제공하는 생성자가 여러 개일 경우 포인터 멤버를 초기화하는 부분인 생성자에서 new 형태를 똑같이 맞출 수 밖에 없음

그렇지 않으면 소멸자에서 어떤 형태의 delete를 사용해야 할지 모르게 됨

---

**new 표현식에 []를 사용했으면. 대응되는 delete 표현식에도 []를 사용해야 함**

**마찬가지로 new 표현식에 []를 안 사용했으면, 대응되는 delete 표현식에도 []를 사용하지 않아야 함**

